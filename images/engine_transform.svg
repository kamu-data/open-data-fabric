<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="505px" preserveAspectRatio="none" style="width:724px;height:505px;" version="1.1" viewBox="0 0 724 505" width="724px" zoomAndPan="magnify"><defs><filter height="300%" id="fnaivb95etiav" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#fnaivb95etiav)" height="385.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="177.5" y="69.4297"/><rect fill="#FFFFFF" filter="url(#fnaivb95etiav)" height="28" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="182.5" y="106.5625"/><rect fill="#FFFFFF" filter="url(#fnaivb95etiav)" height="28" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="182.5" y="261.0938"/><rect fill="#FFFFFF" filter="url(#fnaivb95etiav)" height="28" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="182.5" y="333.2266"/><rect fill="#FFFFFF" filter="url(#fnaivb95etiav)" height="28" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="182.5" y="405.3594"/><rect fill="#FFFFFF" filter="url(#fnaivb95etiav)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="665.5" y="194.8281"/><rect fill="#FFFFFF" filter="url(#fnaivb95etiav)" height="291.7969" style="stroke: #000000; stroke-width: 2.0;" width="588" x="125.5" y="156.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="36" x2="36" y1="38.2969" y2="465.3594"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="182.5" x2="182.5" y1="38.2969" y2="465.3594"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="670.5" x2="670.5" y1="38.2969" y2="465.3594"/><rect fill="#FEFECE" filter="url(#fnaivb95etiav)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="53" x="8" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="15" y="22.9951">Client</text><rect fill="#FEFECE" filter="url(#fnaivb95etiav)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="53" x="8" y="464.3594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="15" y="484.3545">Client</text><rect fill="#FEFECE" filter="url(#fnaivb95etiav)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="90" x="135.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="76" x="142.5" y="22.9951">Coodinator</text><rect fill="#FEFECE" filter="url(#fnaivb95etiav)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="90" x="135.5" y="464.3594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="76" x="142.5" y="484.3545">Coodinator</text><rect fill="#FEFECE" filter="url(#fnaivb95etiav)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="62" x="637.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="48" x="644.5" y="22.9951">Engine</text><rect fill="#FEFECE" filter="url(#fnaivb95etiav)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="62" x="637.5" y="464.3594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="48" x="644.5" y="484.3545">Engine</text><rect fill="#FFFFFF" filter="url(#fnaivb95etiav)" height="385.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="177.5" y="69.4297"/><rect fill="#FFFFFF" filter="url(#fnaivb95etiav)" height="28" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="182.5" y="106.5625"/><rect fill="#FFFFFF" filter="url(#fnaivb95etiav)" height="28" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="182.5" y="261.0938"/><rect fill="#FFFFFF" filter="url(#fnaivb95etiav)" height="28" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="182.5" y="333.2266"/><rect fill="#FFFFFF" filter="url(#fnaivb95etiav)" height="28" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="182.5" y="405.3594"/><rect fill="#FFFFFF" filter="url(#fnaivb95etiav)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="665.5" y="194.8281"/><polygon fill="#A80036" points="165.5,65.4297,175.5,69.4297,165.5,73.4297,169.5,69.4297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="36.5" x2="171.5" y1="69.4297" y2="69.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="43.5" y="64.3638">transform(dataset)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="192.5" x2="234.5" y1="98.5625" y2="98.5625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="234.5" x2="234.5" y1="98.5625" y2="111.5625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="193.5" x2="234.5" y1="111.5625" y2="111.5625"/><polygon fill="#A80036" points="203.5,107.5625,193.5,111.5625,203.5,115.5625,199.5,111.5625" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="251" x="199.5" y="93.4966">prepare_transform_batches(metadata)</text><path d="M125.5,156.5625 L202.5,156.5625 L202.5,163.5625 L192.5,173.5625 L125.5,173.5625 L125.5,156.5625 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="291.7969" style="stroke: #000000; stroke-width: 2.0;" width="588" x="125.5" y="156.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="140.5" y="169.6294">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="99" x="217.5" y="168.7729">[foreach batch]</text><polygon fill="#A80036" points="653.5,190.8281,663.5,194.8281,653.5,198.8281,657.5,194.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="187.5" x2="659.5" y1="194.8281" y2="194.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="459" x="194.5" y="189.7622">execute_query(transaction_id, input_slices, transform, prev_checkpoint)</text><polygon fill="#A80036" points="198.5,219.9609,188.5,223.9609,198.5,227.9609,194.5,223.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="192.5" x2="669.5" y1="223.9609" y2="223.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="173" x="204.5" y="218.895">data_slice, new_checkpoint</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="192.5" x2="234.5" y1="253.0938" y2="253.0938"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="234.5" x2="234.5" y1="253.0938" y2="266.0938"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="193.5" x2="234.5" y1="266.0938" y2="266.0938"/><polygon fill="#A80036" points="203.5,262.0938,193.5,266.0938,203.5,270.0938,199.5,266.0938" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="199.5" y="248.0278">compute_hash(data_slice)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="192.5" x2="234.5" y1="325.2266" y2="325.2266"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="234.5" x2="234.5" y1="325.2266" y2="338.2266"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="193.5" x2="234.5" y1="338.2266" y2="338.2266"/><polygon fill="#A80036" points="203.5,334.2266,193.5,338.2266,203.5,342.2266,199.5,338.2266" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="213" x="199.5" y="320.1606">add_system_columns(data_slice)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="192.5" x2="234.5" y1="397.3594" y2="397.3594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="234.5" x2="234.5" y1="397.3594" y2="410.3594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="193.5" x2="234.5" y1="410.3594" y2="410.3594"/><polygon fill="#A80036" points="203.5,406.3594,193.5,410.3594,203.5,414.3594,199.5,410.3594" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="199.5" y="392.2935">commit(metadata_block)</text><!--MD5=[6907c48a7fd0e1e673654226811e61b6]
@startuml engine_transform

"Client" -> "Coodinator" as C: transform(dataset)
activate C

C -> C: prepare_transform_batches(metadata)
activate C
deactivate C

loop foreach batch

    C -> "Engine" as E:         execute_query(transaction_id, input_slices, transform, prev_checkpoint)
    activate E

    E - -> C: data_slice, new_checkpoint
    deactivate E

    C -> C: compute_hash(data_slice)
    activate C
    deactivate C

    C -> C: add_system_columns(data_slice)
    activate C
    deactivate C

    C -> C: commit(metadata_block)
    activate C
    deactivate C

end

deactivate C

@enduml

PlantUML version 1.2020.07(Sun Apr 19 04:42:40 PDT 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_252-b09
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: CA
--></g></svg>